<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern-IDERule Integration Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar h2 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #34495e;
        }

        .sidebar nav a {
            display: block;
            color: #ecf0f1;
            text-decoration: none;
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 5px;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .sidebar nav a:hover {
            background: #34495e;
            padding-left: 20px;
        }

        .sidebar nav a.active {
            background: #3498db;
        }

        .main-content {
            margin-left: 280px;
            padding: 40px;
            flex: 1;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 10px;
        }

        .status-design {
            background: #3498db;
            color: white;
        }

        .status-pending {
            background: #f39c12;
            color: white;
        }

        .section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .diagram-container {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .card.pattern {
            border-left-color: #3498db;
        }

        .card.rule {
            border-left-color: #f39c12;
        }

        .property-list {
            list-style: none;
            margin-top: 15px;
        }

        .property-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.9rem;
        }

        .property-list li:last-child {
            border-bottom: none;
        }

        .property-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .property-type {
            color: #7f8c8d;
            font-size: 0.85rem;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .use-case {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .use-case h4 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .use-case p {
            opacity: 0.9;
            margin: 10px 0;
        }

        .benefit {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .relationship-box {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .relationship-box h3 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .integration-point {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .query-example {
            margin: 20px 0;
        }

        .query-title {
            background: #3498db;
            color: white;
            padding: 10px 15px;
            border-radius: 5px 5px 0 0;
            font-weight: 600;
        }

        .query-code {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 0 0 5px 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: #1976d2;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h2>Navigation</h2>
            <nav>
                <a href="#overview" class="active">Overview</a>
                <a href="#architecture">Architecture</a>
                <a href="#data-model">Data Model</a>
                <a href="#node-types">Node Types</a>
                <a href="#relationships">Relationships</a>
                <a href="#integration">Integration Points</a>
                <a href="#queries">Query Examples</a>
                <a href="#use-cases">Use Cases</a>
                <a href="#quality">Quality Scoring</a>
                <a href="#independence">System Independence</a>
            </nav>
        </aside>

        <main class="main-content">
            <div class="header">
                <h1>Pattern-IDERule Integration</h1>
                <p style="color: #7f8c8d; margin: 10px 0;">Integration between Pattern Extraction Pipeline and IDE Rule Library</p>
                <div>
                    <span class="status-badge status-design">Design Complete</span>
                    <span class="status-badge status-pending">Implementation Pending</span>
                </div>
                <p style="margin-top: 15px; font-size: 0.9rem; color: #7f8c8d;">Last Updated: 8 January 2026</p>
            </div>

            <section id="overview" class="section">
                <h2>Overview</h2>
                <p>This integration connects two independent knowledge graph systems that share the same Neo4j database:</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">System 1</div>
                        <div class="stat-number">Pattern</div>
                        <div class="stat-label">Extraction Pipeline</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">System 2</div>
                        <div class="stat-number">IDE</div>
                        <div class="stat-label">Rule Library</div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>Key Principle:</strong> Both systems remain independent and can operate alone. The integration provides optional enhancements when both systems are available.
                </div>
            </section>

            <section id="architecture" class="section">
                <h2>Architecture Diagram</h2>
                <div class="diagram-container">
                    <div class="mermaid">
graph TB
    subgraph PatternSystem[Pattern Extraction System]
        Pattern[Pattern Node]
        Requirement[Requirement Node]
        Technology[Technology Node]
        Constraint[Constraint Node]
        
        Pattern -->|SOLVED_BY| Requirement
        Pattern -->|USES| Technology
        Pattern -->|REQUIRES| Constraint
    end
    
    subgraph IDERuleSystem[IDE Rule Library System]
        IDERule[IDERule Node]
    end
    
    subgraph SharedRepo[Shared Repository Context]
        GitHubRepo[GitHub Repository<br/>source_repo URL]
    end
    
    GitHubRepo -.->|source_repo| Pattern
    GitHubRepo -.->|source_repo| IDERule
    
    Pattern -->|HAS_IDE_RULES| IDERule
    
    classDef patternStyle fill:#e1f5ff,stroke:#0066cc
    classDef ruleStyle fill:#fff4e1,stroke:#ff9900
    classDef repoStyle fill:#e8f5e9,stroke:#2e7d32
    
    class Pattern,Requirement,Technology,Constraint patternStyle
    class IDERule ruleStyle
    class GitHubRepo repoStyle
                    </div>
                </div>
            </section>

            <section id="data-model" class="section">
                <h2>Data Model</h2>
                <div class="diagram-container">
                    <div class="mermaid">
classDiagram
    class Pattern {
        +string source_repo
        +string name
        +int stars
        +float quality_score
        +float freshness_score
        +float maintenance_score
        +float validation_score
        +float judge_score
        +string confidence
        +string reasoning
        +boolean needs_review
        +datetime extracted_at
    }
    
    class IDERule {
        +string id
        +string source_repo
        +string file_path
        +string file_format
        +string content
        +string purpose
        +list~string~ categories
        +list~string~ key_practices
        +list~string~ technologies
        +list~string~ project_types
        +list~string~ ide_types
        +float quality_score
        +int confidence_level
        +string quality_breakdown_json
        +boolean has_ci_cd
        +boolean has_tests
        +int stars
        +list~float~ embedding
        +datetime extracted_date
    }
    
    class Requirement {
        +string type
        +string domain
    }
    
    class Technology {
        +string name
    }
    
    class Constraint {
        +string rule
    }
    
    Pattern "1" --> "*" IDERule : HAS_IDE_RULES
    Pattern "*" --> "1" Requirement : SOLVED_BY
    Pattern "*" --> "*" Technology : USES
    Pattern "*" --> "*" Constraint : REQUIRES
                    </div>
                </div>
            </section>

            <section id="node-types" class="section">
                <h2>Node Types</h2>
                
                <div class="card-grid">
                    <div class="card pattern">
                        <h3>Pattern Node</h3>
                        <p>Architectural patterns extracted from repositories</p>
                        <ul class="property-list">
                            <li><span class="property-name">source_repo</span> <span class="property-type">string</span> - GitHub URL</li>
                            <li><span class="property-name">name</span> <span class="property-type">string</span> - Pattern name</li>
                            <li><span class="property-name">stars</span> <span class="property-type">int</span> - Repository stars</li>
                            <li><span class="property-name">quality_score</span> <span class="property-type">float</span> - Multi-dimensional quality</li>
                            <li><span class="property-name">confidence</span> <span class="property-type">string</span> - high/medium/low</li>
                            <li><span class="property-name">needs_review</span> <span class="property-type">boolean</span> - Review flag</li>
                        </ul>
                    </div>

                    <div class="card rule">
                        <h3>IDERule Node</h3>
                        <p>IDE coding rules and configurations from repositories</p>
                        <ul class="property-list">
                            <li><span class="property-name">id</span> <span class="property-type">string</span> - Unique identifier</li>
                            <li><span class="property-name">source_repo</span> <span class="property-type">string</span> - GitHub URL</li>
                            <li><span class="property-name">file_path</span> <span class="property-type">string</span> - Path in repo</li>
                            <li><span class="property-name">file_format</span> <span class="property-type">string</span> - .cursorrules, etc.</li>
                            <li><span class="property-name">quality_score</span> <span class="property-type">float</span> - 7-factor quality (0-100)</li>
                            <li><span class="property-name">embedding</span> <span class="property-type">list[float]</span> - 768-dim semantic vector</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="relationships" class="section">
                <h2>Relationships</h2>
                
                <div class="relationship-box">
                    <h3>HAS_IDE_RULES</h3>
                    <p><strong>Direction:</strong> Pattern → IDERule</p>
                    <p><strong>Cardinality:</strong> One-to-Many (one Pattern can link to multiple IDERule nodes)</p>
                    <p><strong>Purpose:</strong> Links architectural patterns to their actual IDE configuration files</p>
                    <p><strong>Created:</strong> Automatically during pattern extraction when IDE rule files are detected</p>
                    
                    <div class="code-block">CREATE (p:Pattern {source_repo: 'https://github.com/owner/repo'})
CREATE (r:IDERule {id: 'owner/repo:.cursorrules', source_repo: 'https://github.com/owner/repo'})
CREATE (p)-[:HAS_IDE_RULES]->(r)</div>
                </div>
            </section>

            <section id="integration" class="section">
                <h2>Integration Points</h2>
                
                <div class="integration-point">
                    <h3>1. Shared Repository Context</h3>
                    <p>Both systems reference the same <code>source_repo</code> URL (GitHub repository)</p>
                    <div class="code-block">// Find both Pattern and Rules from same repo
MATCH (p:Pattern {source_repo: $repo_url})
MATCH (r:IDERule {source_repo: $repo_url})
RETURN p, r</div>
                </div>

                <div class="integration-point">
                    <h3>2. Direct Relationship</h3>
                    <p>Pattern nodes are directly linked to their IDERule nodes</p>
                    <div class="code-block">// Find Pattern with its IDE rules
MATCH (p:Pattern)-[:HAS_IDE_RULES]->(r:IDERule)
RETURN p, r</div>
                </div>

                <div class="integration-point">
                    <h3>3. Quality Cross-Reference</h3>
                    <p>Both systems calculate quality scores independently for enhanced verification</p>
                    <div class="code-block">// Compare pattern and rule quality
MATCH (p:Pattern)-[:HAS_IDE_RULES]->(r:IDERule)
RETURN p.source_repo,
       p.quality_score as pattern_quality,
       avg(r.quality_score) as avg_rule_quality,
       abs(p.quality_score - avg(r.quality_score)) as quality_diff
ORDER BY quality_diff DESC</div>
                </div>
            </section>

            <section id="queries" class="section">
                <h2>Query Examples</h2>
                
                <div class="query-example">
                    <div class="query-title">Find Pattern with its IDE Rules</div>
                    <div class="query-code">MATCH (p:Pattern {source_repo: 'https://github.com/owner/repo'})-[:HAS_IDE_RULES]->(r:IDERule)
RETURN p.name, r.file_path, r.file_format, r.quality_score</div>
                </div>

                <div class="query-example">
                    <div class="query-title">Find Top-Quality Patterns with Verified Rules</div>
                    <div class="query-code">MATCH (p:Pattern)-[:HAS_IDE_RULES]->(r:IDERule)
WHERE p.quality_score > 70 AND r.quality_score > 60
RETURN p.name, p.quality_score, collect(r.file_format) as rule_formats
ORDER BY p.quality_score DESC
LIMIT 10</div>
                </div>

                <div class="query-example">
                    <div class="query-title">Find Patterns with Rules for Specific Technologies</div>
                    <div class="query-code">MATCH (p:Pattern)-[:USES]->(t:Technology {name: 'python'})
MATCH (p)-[:HAS_IDE_RULES]->(r:IDERule)
WHERE 'python' IN r.technologies
RETURN p.name, r.file_format, r.purpose</div>
                </div>

                <div class="query-example">
                    <div class="query-title">Find Patterns with Complete Rule Coverage</div>
                    <div class="query-code">MATCH (p:Pattern)-[:HAS_IDE_RULES]->(r:IDERule)
WITH p, collect(DISTINCT r.file_format) as formats
WHERE size(formats) >= 3  // Has multiple rule formats
RETURN p.name, formats, size(formats) as format_count
ORDER BY format_count DESC</div>
                </div>
            </section>

            <section id="use-cases" class="section">
                <h2>Use Cases</h2>
                
                <div class="use-case">
                    <h4>1. Pattern Discovery with Configuration Context</h4>
                    <p>Find architectural patterns that include working IDE configurations</p>
                    <div class="benefit">
                        <strong>Benefit:</strong> Get patterns with proven, configured development environments
                    </div>
                </div>

                <div class="use-case">
                    <h4>2. Quality Verification</h4>
                    <p>Cross-check pattern quality with rule quality for enhanced confidence</p>
                    <div class="benefit">
                        <strong>Benefit:</strong> Higher confidence in pattern quality through multiple signals
                    </div>
                </div>

                <div class="use-case">
                    <h4>3. IDE-Specific Pattern Discovery</h4>
                    <p>Find patterns with rules for your IDE (e.g., Cursor)</p>
                    <div class="benefit">
                        <strong>Benefit:</strong> Get patterns ready-to-use in your development environment
                    </div>
                </div>

                <div class="use-case">
                    <h4>4. Technology Stack Validation</h4>
                    <p>Verify patterns have IDE rules for required tech stack</p>
                    <div class="benefit">
                        <strong>Benefit:</strong> Ensure patterns have relevant coding standards for your stack
                    </div>
                </div>

                <div class="use-case">
                    <h4>5. Semantic Search Enhancement</h4>
                    <p>Use rule embeddings to find semantically similar patterns</p>
                    <div class="benefit">
                        <strong>Benefit:</strong> Natural language discovery of patterns through their rule content
                    </div>
                </div>
            </section>

            <section id="quality" class="section">
                <h2>Quality Scoring Comparison</h2>
                
                <div class="card-grid">
                    <div class="card pattern">
                        <h3>Pattern Quality Score</h3>
                        <p><strong>Range:</strong> 0-100</p>
                        <ul class="property-list">
                            <li>Popularity score (stars, forks)</li>
                            <li>Maintenance score (commits, releases)</li>
                            <li>Maturity score (age, stability)</li>
                            <li>Community score (contributors, issues)</li>
                            <li>Freshness score (recent activity)</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>System:</strong> quality_metrics.py</p>
                    </div>

                    <div class="card rule">
                        <h3>IDERule Quality Score</h3>
                        <p><strong>Range:</strong> 0-100</p>
                        <ul class="property-list">
                            <li>Star velocity (20 pts) - Stars per year</li>
                            <li>Freshness (20 pts) - Days since update</li>
                            <li>Issue health (15 pts) - Closed vs open</li>
                            <li>Contributor diversity (15 pts)</li>
                            <li>Production readiness (20 pts)</li>
                            <li>Documentation (5 pts)</li>
                            <li>Usage signal (5 pts)</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>System:</strong> quality_scorer.py</p>
                    </div>
                </div>
            </section>

            <section id="independence" class="section">
                <h2>System Independence</h2>
                
                <div class="info-box">
                    <strong>Important:</strong> Both systems remain fully independent and can operate without each other.
                </div>

                <div class="card-grid">
                    <div class="card pattern">
                        <h3>Pattern System Can Work Alone</h3>
                        <ul class="property-list">
                            <li>All pattern extraction logic unchanged</li>
                            <li>Pattern queries work without IDE rules</li>
                            <li>No dependencies on ide_rule_library/</li>
                        </ul>
                    </div>

                    <div class="card rule">
                        <h3>IDE Rule System Can Work Alone</h3>
                        <ul class="property-list">
                            <li>All rule extraction logic unchanged</li>
                            <li>Rule queries work without patterns</li>
                            <li>No dependencies on pattern_extraction_pipeline/</li>
                        </ul>
                    </div>
                </div>

                <div class="integration-point">
                    <h3>Graceful Degradation</h3>
                    <ul class="property-list">
                        <li>Missing IDE rule library → Pattern extraction continues</li>
                        <li>Missing patterns → Rule extraction continues</li>
                        <li>Broken relationships → Both systems query independently</li>
                    </ul>
                </div>
            </section>

            <div class="section">
                <h2>Implementation Status</h2>
                <div class="info-box">
                    <strong>Current Status:</strong> Design Complete | Not Yet Implemented
                </div>
                <p style="margin-top: 20px;">When implemented:</p>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>Pattern extraction will automatically detect IDE rule files</li>
                    <li>Rules will be extracted and linked during pattern analysis</li>
                    <li>Query interfaces will support rule inclusion</li>
                    <li>Both systems remain independent</li>
                </ol>
            </div>
        </main>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'base',
            themeVariables: {
                primaryColor: '#e1f5ff',
                primaryTextColor: '#333',
                primaryBorderColor: '#0066cc',
                lineColor: '#666',
                secondaryColor: '#fff4e1',
                tertiaryColor: '#e8f5e9'
            }
        });

        // Smooth scrolling for navigation
        document.querySelectorAll('.sidebar nav a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Update active link
                document.querySelectorAll('.sidebar nav a').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Update active link on scroll
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const scrollPos = window.scrollY + 100;

            sections.forEach(section => {
                const top = section.offsetTop;
                const height = section.offsetHeight;
                const id = section.getAttribute('id');

                if (scrollPos >= top && scrollPos < top + height) {
                    document.querySelectorAll('.sidebar nav a').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${id}`) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>
